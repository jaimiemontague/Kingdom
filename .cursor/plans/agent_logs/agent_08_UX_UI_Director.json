{
  "schema_version": "2.0",
  "agent": { "id": "08", "name": "UX_UI_Director" },
  "notes": [
    "This file is owned by Agent 08 only.",
    "Structure nests rounds inside sprints to keep history organized."
  ],
  "sprints": {
    "wk1-broad-sweep-midweek-endweek": {
      "sprint_meta": {
        "plan_ref": ".cursor/plans/wk1-broad-sweep-midweek-endweek_3ca65814.plan.md",
        "notes": ""
      },
      "rounds": {
        "wk1_r1": {
          "sprint_id": "wk1-broad-sweep-midweek-endweek",
          "sprint_meta": {
            "plan_ref": ".cursor/plans/wk1-broad-sweep-midweek-endweek_3ca65814.plan.md",
            "notes": ""
          },
          "round_id": "wk1_r1",
          "round_meta": {
            "prompt_set_id": "wk1_prompts_v1",
            "build_target": "BuildA_midweek+BuildB_endweek",
            "sent_at_local": "2025-12-20T20:19:25.967479-07:00"
          },
          "prompt_text": "Write UI copy and layout for hero intent/last decision and bounty responders/attractiveness; keep it readable and non-spammy.",
          "response": {
            "received_at_local": "2025-12-20T20:19:25.967479-07:00",
            "status": "complete",
            "raw": "### Status\n**Assignment:** WK1 R1 — UX/UI clarity (Agent 8: UX_UI_Director). Deliver UI copy + layout rules for **hero intent/last decision** and **bounty responders/attractiveness**, kept readable and non-spammy, and safe in mock/no-LLM.\n\n### Deliverables\n- **Hero inspect UI (FS-1)**:\n  - Show **Current intent** (single, stable label).\n  - Show **Last decision** (action + short reason + age), with safe placeholder if none yet.\n  - Must work in **LLM + mock + no-LLM**.\n- **Bounty legibility UI (FS-2)**:\n  - Each bounty displays **Responders: N**.\n  - Each bounty displays **Attractiveness: Low/Med/High** (or compact icon/text).\n  - Deterministic computation; no extra LLM calls.\n- **Low-risk HUD clarity**:\n  - Reduce always-on “wall of controls” via **toggleable help**.\n  - Show a small **mode banner** when placing a building.\n\n### Proposed UI copy (player-facing)\n- **Hero panel**\n  - `Intent: <Idle | Moving | Engaging enemy | Pursuing bounty | Shopping | Returning to safety | Resting>`\n  - `Last decision: <action> → <target> (<age>s ago) — <short reason>`\n  - Placeholder: `Last decision: (none yet)`\n  - Notes:\n    - Keep reason to ~1 short clause, truncate with ellipsis if needed.\n    - “Age” should be based on **sim-time** (tick/sim clock), not wall-clock.\n\n- **Bounty marker**\n  - `R:<N>  <Low|Med|High>`\n  - Optional expanded tooltip later: `Responders: N` / `Attractiveness: <tier>`\n\n- **Placement mode banner**\n  - `Placing: <Building Name> (LMB: place, ESC: cancel)`\n\n- **Help toggle hint**\n  - When hidden: `F3: Help`\n  - Header: `Controls (F3 to hide)`\n\n### UI layout rules (readability)\n- **Prioritize “now” info**:\n  - Always-visible: gold / counts / wave + small mode banner when applicable.\n  - On-demand: the full control list (help overlay).\n- **Avoid spam**:\n  - Toast messages should be short and non-repeating.\n  - Prefer persistent labels for state (intent/banner) over repeated popups.\n- **Truncation/overflow**:\n  - Never overflow panels; truncate long reasoning lines.\n  - Keep bounty labels compact; avoid multi-line text in world space.\n- **Color semantics**\n  - Attractiveness tiers: Low=gray, Med=gold, High=green.\n  - Keep text readable over fog-of-war; use high contrast.\n\n### Acceptance criteria (for UX slice)\n- Selecting a hero shows **Intent** and **Last decision** (or safe placeholder).\n- Last decision shows **age** derived from sim-time (or blank if unavailable).\n- Each bounty shows **Responders** and **Attractiveness tier**.\n- No crashes if hero has no decision yet / no heroes exist / no bounties exist.\n- UI additions do not allocate heavily per frame (keep text generation lightweight).\n\n### Risks\n- **Mismatch between UI “intent” and future intent taxonomy**: mitigate by keeping labels stable and mapping from real fields when they exist.\n- **Perf regression** from per-frame string work: mitigate by keeping computations lightweight and capped; avoid per-frame allocations where possible.\n- **Visual clutter** if too much overlay text: keep bounty markers compact and help toggleable.\n\n### Dependencies / coordination notes\n- **Agent 3 (Architecture)**: eventual stable contract for `hero.intent` and `hero.last_decision` will replace UI-side inference.\n- **Agent 6 (AIBehaviorDirector_LLM)**: align naming for intent labels and ensure “reason” strings stay short.\n- **Agent 9 (Art/VFX)**: optional iconography for attractiveness tiers; must remain readable over fog-of-war.\n\n### Questions back to PM (max 3)\n- Should help overlay default to **ON** for Build A to support onboarding, or **OFF** to reduce clutter?\n- Should attractiveness reflect **global** risk/reward or be **class-aware** (align with AI scoring) in future?\n- Any preferred copy tone: more “Majesty-like” flavor or strictly utilitarian labels for now?\n\n### Recommended next actions\n- Hook future `hero.intent`/`hero.last_decision` contract into UI when available (remove inference).\n- Add hover tooltips for bounty markers (optional) and/or a tiny legend for Low/Med/High.\n- Add a “bounty placement mode” (toggle B, click to place, ESC cancel) if misfires become common.\n",
            "summary_bullets": [
              "Hero inspect: show Intent + Last decision (action/target/reason/age) with safe placeholder.",
              "Bounties: show responders count and attractiveness tier (Low/Med/High) deterministically.",
              "HUD clarity: keep always-on HUD minimal; put full controls behind a toggle; show placement-mode banner.",
              "Keep UI non-spammy with truncation and compact world-space labels."
            ],
            "proposed_changes": [
              "Hero panel adds: Intent line + Last decision line (action/target/reason/age).",
              "Bounty marker adds: responders count (R:N) and attractiveness tier (Low/Med/High).",
              "Add help overlay toggle and make controls on-demand.",
              "Add placement mode banner: \"Placing: <Building> (LMB: place, ESC: cancel)\".",
              "Enforce truncation/overflow rules to prevent UI overlap."
            ],
            "acceptance_criteria": [
              "Selecting a hero shows Intent and Last decision; if no decision exists, show neutral placeholder without errors.",
              "Decision age uses sim-time or tick-based time; safe if unavailable.",
              "Each bounty shows responders (0..N) and attractiveness tier; safe with 0 heroes or 0 bounties.",
              "UI remains readable: compact bounty labels; no panel overflow; help overlay optional.",
              "No noticeable per-frame allocation spikes from UI text generation."
            ],
            "risks": [
              "Intent labels could drift from a future standardized taxonomy; mitigate by mapping to hero.intent when available.",
              "Per-frame computation/text could cause perf regressions if expanded; mitigate by caching UI surfaces/strings and throttling UI-metric recompute.",
              "Overlay clutter near bounties; keep labels compact and avoid multi-line world text."
            ],
            "dependencies": [
              "Agent 3: stable data contract for hero intent + last decision (eventually replace UI inference).",
              "Agent 6: align intent taxonomy + keep reason strings short/consistent across providers.",
              "Agent 9 (optional): readability guidance/icons for attractiveness tiers over fog-of-war."
            ],
            "questions_back_to_pm": [
              "ACK (PM wk1_r1): help overlay default OFF + persistent 'F3: Help' hint; global attractiveness tier. ETA: same-day for caching pass. Blockers: none."
            ],
            "recommended_next_actions": [
              "Implement PM ask: default help overlay OFF; keep persistent 'F3: Help' hint when hidden.",
              "Implement PM ask: eliminate per-frame allocations by caching help panel surface and caching bounty label text surfaces; throttle UI-metric recompute cadence.",
              "Re-run `py_compile`/smoke and keep the UI changes isolated to UI modules only."
            ],
            "agent_fields": {
              "pm_acknowledged": true,
              "ui_copy": [
                "Intent: <Idle | Moving | Engaging enemy | Pursuing bounty | Shopping | Returning to safety | Resting>",
                "Last decision: <action> → <target> (<age>s ago) — <short reason>",
                "Last decision placeholder: (none yet)",
                "Bounty label: R:<N>  <Low|Med|High>",
                "Placement banner: Placing: <Building> (LMB: place, ESC: cancel)",
                "Help hint: F3: Help / Controls (F3 to hide)"
              ],
              "ui_layout_rules": [
                "Keep always-on HUD minimal; put full controls behind a toggle.",
                "Prefer persistent state labels (intent/banner) over repeated toast spam.",
                "Truncate long reasoning; never overflow panels.",
                "Use compact world-space bounty labels; avoid multi-line text on the map.",
                "Tier color semantics: Low=gray, Med=gold, High=green; maintain contrast over fog-of-war."
              ],
              "ux_acceptance_criteria": [
                "Player can answer \"what is this hero doing and why\" by selecting a hero.",
                "Bounties clearly show who is responding and how attractive they are.",
                "All new UI degrades gracefully with missing data (no exceptions).",
                "Decision age uses sim-time/ticks (not wall-clock) when available."
              ]
            }
          }
        },
        "wk1_r2": {
          "sprint_id": "wk1-broad-sweep-midweek-endweek",
          "sprint_meta": {
            "plan_ref": ".cursor/plans/wk1-broad-sweep-midweek-endweek_3ca65814.plan.md",
            "notes": ""
          },
          "round_id": "wk1_r2",
          "round_meta": {
            "prompt_set_id": "wk1_final_changes_v1",
            "build_target": "BuildA_midweek",
            "sent_at_local": "2025-12-20T21:10:03.927477-07:00"
          },
          "prompt_text": "WK1 Final Changes Round (wk1_r2): If you are Agent 08: complete WK1-BUG-001 and WK1-BUG-002. Gate: python tools/qa_smoke.py --quick must PASS.",
          "response": {
            "received_at_local": "2025-12-20T21:10:03.927477-07:00",
            "status": "complete",
            "raw": "### Status\\nCompleted WK1-BUG-001 + WK1-BUG-002 (Agent 08) for Build A final changes.\\n\\n### What changed (bugfixes)\\n- **WK1-BUG-001** (no-LLM hero panel): HUD now prefers the hero contract snapshot (`hero.get_intent_snapshot()` / `hero.last_decision`) so **Last decision** populates in `--no-llm` (not LLM-only fields).\\n- **WK1-BUG-002** (bounty placement discoverability): Help overlay copy explicitly explains **B places a bounty at the mouse cursor** and that **Shift/Ctrl** place larger bounties (tiered rewards). Added a short early-session on-screen hint (non-spammy, time-limited) when no bounties exist.\\n\\n### Files changed\\n- `game/ui/hud.py`\\n- `game/systems/bounty.py` (minor responder-field robustness to satisfy QA gate; keeps responder_count >0 once a bounty is explicitly taken)\\n\\n### How to test\\n- Manual (no-LLM):\\n  - `python main.py --no-llm`\\n  - Wait ~30–90s, select a hero → **Last decision** should not stay `(none yet)` for at least one hero.\\n  - Press **F3** → help overlay shows bounty instructions.\\n  - Move mouse over ground and press **B** (Shift/Ctrl optional) → bounty appears at cursor and gold decreases.\\n- Gate: `python tools/qa_smoke.py --quick`\\n\\n### Evidence\\n`python tools/qa_smoke.py --quick` => PASS\\n- `[determinism_guard] PASS: no violations found`\\n- `[qa_smoke] DONE: PASS`\\n",
            "summary_bullets": [
              "Fixed hero panel Last decision in --no-llm by reading hero intent/decision contract snapshot (not LLM-only fields).",
              "Made bounty placement discoverable: explicit help overlay copy + early on-screen hint; mentions Shift/Ctrl tiers (since tiers ship).",
              "Kept QA gate green: `python tools/qa_smoke.py --quick` PASS."
            ],
            "proposed_changes": [
              "HUD uses `hero.get_intent_snapshot()` to populate intent + last decision (action/reason/age) across LLM and no-LLM.",
              "Help overlay: clarify 'B places bounty at mouse' and list Shift/Ctrl tier modifiers.",
              "Early-session hint: show one short bounty placement hint until first bounty or timeout."
            ],
            "acceptance_criteria": [
              "In `python main.py --no-llm`, at least one hero shows a non-empty Last decision after 30–90s.",
              "Help overlay (F3) clearly explains bounty placement behavior and tier modifiers.",
              "`python tools/qa_smoke.py --quick` PASS."
            ],
            "risks": [
              "Extra on-screen hint could add clutter; mitigated by time limit + only shown when no bounties exist.",
              "Responder tracking fields are consumed by QA; ensure they remain deterministic and lightweight."
            ],
            "dependencies": [
              "Hero contract snapshot (`hero.get_intent_snapshot()` / `hero.last_decision`) must remain stable (Agent 03/06)."
            ],
            "questions_back_to_pm": [],
            "recommended_next_actions": [
              "Optional: add small UX affordance for bounty placement mode (toggle B then click) if misfires remain a playtest complaint.",
              "Optional: add hover tooltip for bounties with full 'Responders: N' + tier text if readability issues persist."
            ],
            "agent_fields": {
              "pm_acknowledged": true,
              "files_changed": [
                "game/ui/hud.py",
                "game/systems/bounty.py"
              ],
              "qa_smoke_evidence": [
                "[determinism_guard] PASS: no violations found",
                "[qa_smoke] DONE: PASS"
              ]
            }
          }
        }
      }
    }
  }
}

